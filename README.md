Unholy undocumented mess at the moment.

Refactoring and documentation coming soon!
